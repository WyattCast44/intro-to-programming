from time import time
from app.Steps import Intro


class Game:

    intro = """
                            
        ████████╗██╗  ██╗███████╗                                                                                     
        ╚══██╔══╝██║  ██║██╔════╝                                                                                     
           ██║   ███████║█████╗                                                                                       
           ██║   ██╔══██║██╔══╝                                                                                       
           ██║   ██║  ██║███████╗                                                                                     
           ╚═╝   ╚═╝  ╚═╝╚══════╝                                                                                     
         █████╗ ██████╗ ██╗   ██╗███████╗███╗   ██╗████████╗██╗   ██╗██████╗ ███████╗███████╗     ██████╗ ███████╗    
        ██╔══██╗██╔══██╗██║   ██║██╔════╝████╗  ██║╚══██╔══╝██║   ██║██╔══██╗██╔════╝██╔════╝    ██╔═══██╗██╔════╝    
        ███████║██║  ██║██║   ██║█████╗  ██╔██╗ ██║   ██║   ██║   ██║██████╔╝█████╗  ███████╗    ██║   ██║█████╗      
        ██╔══██║██║  ██║╚██╗ ██╔╝██╔══╝  ██║╚██╗██║   ██║   ██║   ██║██╔══██╗██╔══╝  ╚════██║    ██║   ██║██╔══╝      
        ██║  ██║██████╔╝ ╚████╔╝ ███████╗██║ ╚████║   ██║   ╚██████╔╝██║  ██║███████╗███████║    ╚██████╔╝██║         
        ╚═╝  ╚═╝╚═════╝   ╚═══╝  ╚══════╝╚═╝  ╚═══╝   ╚═╝    ╚═════╝ ╚═╝  ╚═╝╚══════╝╚══════╝     ╚═════╝ ╚═╝         
        ███████╗████████╗ █████╗ ██████╗ ███╗   ███╗ █████╗ ███╗   ██╗                                                
        ██╔════╝╚══██╔══╝██╔══██╗██╔══██╗████╗ ████║██╔══██╗████╗  ██║                                                
        ███████╗   ██║   ███████║██████╔╝██╔████╔██║███████║██╔██╗ ██║                                                
        ╚════██║   ██║   ██╔══██║██╔══██╗██║╚██╔╝██║██╔══██║██║╚██╗██║                                                
        ███████║   ██║   ██║  ██║██║  ██║██║ ╚═╝ ██║██║  ██║██║ ╚████║                                                
        ╚══════╝   ╚═╝   ╚═╝  ╚═╝╚═╝  ╚═╝╚═╝     ╚═╝╚═╝  ╚═╝╚═╝  ╚═══╝                                                
             
    """

    outro = """
        
        ▄████  ▄▄▄       ███▄ ▄███▓▓█████     ▒█████   ██▒   █▓▓█████  ██▀███  
        ██▒ ▀█▒▒████▄    ▓██▒▀█▀ ██▒▓█   ▀    ▒██▒  ██▒▓██░   █▒▓█   ▀ ▓██ ▒ ██▒
        ▒██░▄▄▄░▒██  ▀█▄  ▓██    ▓██░▒███      ▒██░  ██▒ ▓██  █▒░▒███   ▓██ ░▄█ ▒
        ░▓█  ██▓░██▄▄▄▄██ ▒██    ▒██ ▒▓█  ▄    ▒██   ██░  ▒██ █░░▒▓█  ▄ ▒██▀▀█▄  
        ░▒▓███▀▒ ▓█   ▓██▒▒██▒   ░██▒░▒████▒   ░ ████▓▒░   ▒▀█░  ░▒████▒░██▓ ▒██▒
        ░▒   ▒  ▒▒   ▓▒█░░ ▒░   ░  ░░░ ▒░ ░   ░ ▒░▒░▒░    ░ ▐░  ░░ ▒░ ░░ ▒▓ ░▒▓░
        ░   ░   ▒   ▒▒ ░░  ░      ░ ░ ░  ░     ░ ▒ ▒░    ░ ░░   ░ ░  ░  ░▒ ░ ▒░
        ░ ░   ░   ░   ▒   ░      ░      ░      ░ ░ ░ ▒       ░░     ░     ░░   ░ 
            ░       ░  ░       ░      ░  ░       ░ ░        ░     ░  ░   ░     
                                                            ░                   

    """

    def __init__(self, application):

        self.application = application

        # Capture the start time
        self.application.state().upsert('game_start', time())

        # Clear the console
        self.application.clearConsole()

        # Print the banner
        self.application.output().success(self.intro)

        return

    def run(self):

        # Set the first step
        self.application.state().upsert('next_step', Intro)

        # Run the game until game over
        while not self.application.state().get('game_over', False):

            self.application.state().get('next_step')(self.application, self).run()

        return

    def end(self):

        self.application.state().upsert('game_end', time())

        self.application.state().upsert('game_over', True)

        self.application.output().error(self.outro)

        quit()

        return
